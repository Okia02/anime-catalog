"use strict";const inputSearch=document.querySelector(".js-input-search"),submitBtn=document.querySelector(".js-submit-btn"),resetBtn=document.querySelector(".js-reset-btn"),searchResults=document.querySelector(".js-result-list"),resetBtnFav=document.querySelector(".js-reset-btn-fav"),favResults=document.querySelector(".js-fav-list");let animes=[],favAnimes=[];function getUserInput(e){e.preventDefault(),fetch("https://api.jikan.moe/v3/search/anime?q="+inputSearch.value).then(e=>e.json()).then(e=>{animes=e.results,renderResults()})}function handlerResetBtnFav(e){e.preventDefault(),favResults.innerHTML="",localStorage.clear(),location.reload()}function handlerResetBtn(e){e.preventDefault(),location.reload()}function renderResults(){searchResults.innerHTML="";for(const e of animes){let t="";t=void 0!==favAnimes.find(t=>t.mal_id===e.mal_id)?"fav":"";let n=!0===e.airing?`<a class='js-airing' href='${e.url}'>More details</a>`:"<p class='js-not-airing'>Not airing</p>";searchResults.innerHTML+=`<li class='li-element js-li-element ${t}' id='${e.mal_id}'><img class='anime-img' src='${e.image_url||"https://via.placeholder.com/210x295/ffffff/666666/?text=TV"}'><h3 class='anime-title'>${e.title}</h3><div>${n}</div></li>`}handlerClickedAnime()}function renderFavResults(){favResults.innerHTML="";for(let e=0;e<favAnimes.length;e++){const t=favAnimes[e];favResults.innerHTML+=`<li class='li-element js-li-element' id='${t.mal_id}'><img class='anime-img' src='${t.image_url||"https://via.placeholder.com/210x295/ffffff/666666/?text=TV"}'><h3 class='anime-title'>${t.title}</h3><i class="fas fa-times"></i></li>`}handlerClickedAnime()}function handlerClickedFav(e){e.preventDefault();const t=parseInt(e.currentTarget.id),n=favAnimes.findIndex(e=>e.mal_id===t);if(-1===n){const e=animes.find(e=>e.mal_id===t);favAnimes.push(e)}else favAnimes.splice(n,1),console.log(favAnimes[n].title);renderResults(),renderFavResults(),setInLocalStorage()}function handlerClickedAnime(){const e=document.querySelectorAll(".js-li-element");for(const t of e)t.addEventListener("click",handlerClickedFav)}function setInLocalStorage(){const e=JSON.stringify(favAnimes);localStorage.setItem("anime",e)}function getInLocalStorage(){const e=localStorage.getItem("anime");favAnimes=JSON.parse(e),null===favAnimes?favAnimes=[]:renderFavResults()}submitBtn.addEventListener("click",getUserInput),resetBtn.addEventListener("click",handlerResetBtn),resetBtnFav.addEventListener("click",handlerResetBtnFav),getInLocalStorage();